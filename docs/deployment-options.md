# MoneyPath 本番環境デプロイ

## デプロイ方法

**AWS EC2 + Docker Compose** でデプロイします。

## 構成概要

```
AWS EC2 (Ubuntu 24.04 LTS)
├── Docker Engine
├── Docker Compose
└── MoneyPath Application
    ├── app コンテナ (Next.js)
    └── db コンテナ (MySQL 8.0)
```

## スペック

- **EC2インスタンス**: t2.micro（無料枠対象）
- **vCPU**: 1コア
- **メモリ**: 1GB
- **ストレージ**: 30GB EBS (gp3)
- **OS**: Ubuntu Server 24.04 LTS

## コスト

### 1年目（AWS無料利用枠）

- **EC2 t2.micro**: 月750時間まで無料 → **0円**
- **EBS 30GB**: 30GBまで無料 → **0円**
- **データ転送**: 15GBまで無料 → **0円**
- **Elastic IP**: インスタンス関連付け中は無料 → **0円**
- **合計**: **ほぼ0円**（数百円程度）

### 2年目以降

- **EC2 t2.micro**: 約3,000円/月
- **EBS 30GB**: 約300円/月
- **データ転送**: 約100〜500円/月
- **Elastic IP**: 関連付け中は無料
- **合計**: **約3,500〜4,200円/月**

## セットアップ時間

- **初回デプロイ**: 約2〜3時間
- **2回目以降**: 約30分

## メリット

- ✅ **1年目ほぼ無料**（AWS無料枠）
- ✅ **Docker Compose使用**（開発環境と同じ構成）
- ✅ **MySQL使用**（PostgreSQL移行不要）
- ✅ **AWSスキル習得**（実践的な学習）
- ✅ **スリープなし**（常時稼働）
- ✅ **スケーラブル**（将来的な拡張が容易）

## デメリット

- ❌ セットアップがやや複雑（初回は2〜3時間）
- ❌ 2年目以降は月額課金（約4,200円）
- ❌ サーバー管理が必要（セキュリティアップデート等）

---

## デプロイ手順

詳細な手順は以下のドキュメントを参照してください：

👉 **[AWS EC2デプロイ手順書](./aws-ec2-deployment-guide.md)**

### 手順の概要

1. **AWSアカウント作成**（10分）
2. **EC2インスタンス起動**（20分）
   - t2.microインスタンス作成
   - Elastic IP割り当て
   - セキュリティグループ設定
3. **環境セットアップ**（30分）
   - Docker & Docker Composeインストール
   - Gitインストール
4. **アプリケーションデプロイ**（60分）
   - リポジトリクローン
   - 本番用docker-compose.yml作成
   - 本番用Dockerfile作成
   - 環境変数設定
   - ビルド＆起動
5. **動作確認**（10分）
6. **本番運用設定**（30分）
   - SSL証明書設定（オプション）
   - 自動起動設定
   - バックアップ設定

---

## よくある質問

### Q1. EC2でDockerは使えますか？

**A.** はい、使えます。EC2インスタンス上にDocker & Docker Composeをインストールして、開発環境と同じようにコンテナを起動します。

### Q2. データベースはどうなりますか？

**A.** MySQLコンテナをEC2上で起動します。開発環境と同じMySQL 8.0を使用するため、PostgreSQLへの移行は不要です。

### Q3. SSLは必要ですか？

**A.** 本番環境ではHTTPS化を推奨しますが、初期段階ではHTTPで動作確認できます。SSL化にはドメイン名が必要です。

### Q4. 無料枠が終わった後も使い続けられますか？

**A.** はい、2年目以降は月額約4,200円で継続利用できます。

### Q5. スケールアップは簡単ですか？

**A.** はい、インスタンスタイプを変更するだけでスペックアップできます。また、将来的にRDS（マネージドMySQL）やECS（コンテナ管理サービス）への移行も可能です。

---

## 次のステップ

1. [AWS EC2デプロイ手順書](./aws-ec2-deployment-guide.md)を開く
2. ステップ1から順番に実行
3. デプロイ完了！

---

## トラブル時の連絡先

- AWS公式サポート: https://aws.amazon.com/jp/support/
- MoneyPath GitHub Issues: （リポジトリのIssuesページ）
